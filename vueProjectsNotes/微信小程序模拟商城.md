## 新建项目

不使用云服务

~~~javascript
utils->app.js
注释本地存储能力

pages下的文件夹全删

~~~

~~~javascript
配置
utils->app.json
  "pages": [
    "pages/home/index",
    "pages/category/index",
	"pages/cart/index",
    "pages/me/index",
  ],
js控制逻辑 json是配置 wxml标签语言

  "window": {
    "backgroundTextStyle": "light", // 文本的背景颜色
    "navigationBarBackgroundColor": "#fbf9fe",	// 导航背景颜色
    "navigationBarTitleText": "xujing",
    "navigationBarTextStyle": "black",
    "backgroundColor":"#fbf9fe"
  },
~~~



## 配置tabBar

~~~javascript
查看文档
全局配置
app.json
"tabBar": {
    "color"": "#959394",
    "selectedColor": "#e93b3d",
     "borderStyle":"black",
     "backgroundColor": ""#fff,
    "list": [
      {
        "pagePath": "pages/index/index",
        "iconPath": ""
        "selectedIconPath": 
        "text": "首页"
      },
      {
        "pagePath": "pages/logs/logs",
        "text": "分类"
      }6
    ]
  },
  
页面配置
{
  "navigationBarTitleText": "首页"
}
把素材images拷贝到根目录
~~~



## 获取头像昵称

结构

~~~html
<view class="container">
  <view class="userinfo">
    <button wx:if="{{!hasUserInfo && canIUse}}"> 获取头像昵称 </button>
    <block wx:else>
      <image src="{{userInfo.avatarUrl}}" background-size="cover"></image>
      <text class="userinfo-nickname">{{userInfo.nickName}}</text>
    </block>
  </view>
</view>
~~~

样式

~~~css
.userinfo {
  display: flex;
  flex-direction: column;
  align-items: center;
}
.userinfo button{
  margin-top: 100rpx;
  background-color: #fff
}
.userinfo-avatar {
  width: 128rpx;
  height: 128rpx;
  margin: 20rpx;
  border-radius: 50%;
}

.userinfo-nickname {
  color: #aaa;
}

.usermotto {
  margin-top: 200px;
}
~~~

逻辑

~~~javascript
  data: {
    userInfo:{},
    hasUserInfo: false,
    canIUse:wx.canIUse("button.open-type.getUserInfo") // 注意这里 结构中要绑定
  },
      
  // 绑定方法
 <button wx:if="{{!hasUserInfo && canIUse}}" open-type="getUserInfo" bindgetuserInfo="getUserInfo"> 获取头像昵称 </button>

// 实现方法
// 获取用户信息
getUserInfo: function(e) {
    console.log(e);
    this.setData({
      userInfo: e.detail.userInfo,
      hasUserInfo: true
    })
  }

记得给头像image加上类名userinfo-avatar 因为已经写好了样式
 
~~~

注意刷新后又要重新获取头像

## 解决用户授权

~~~html
获取的用户信息会存在全局变量中
app.js中
  globalData: {
    userInfo: null
  }
~~~

~~~javascript
me-> index.js
// 获取用户实例getApp方法(wx提供的) 也就是可以拿到app.js中的globalData
const app = getApp();
console.log(app); // 打印看看app的内容

  /**
     * 生命周期函数--监听页面加载
     */
  onLoad: function (options) {
    if(app.globalData.userInfo){
      this.setData({
        userInfo: app.globalData.userInfo,
        hasUserInfo:true
      })
    }else if(this.data.canIUse){
        // getUserInfo是网络请求,可能会在page.onload之后才返回
        // 为了防止这种情况发生,此处用回调
        app.userInfoReadyCallback = res=>{
            this.setData({
                 userInfo: res.userInfo,
       		 	hasUserInfo: true
            })
        }
    }
  },
~~~



