## 启动项目

下载源码安装前后端依赖

~~~shell
# 在前后端代码目录下 安装后代依赖
cnpm install

# 全局安装nodemon
npm install -g nodemon

# 运行后端
nodemon

# cd 到前端文件夹下 安装前端依赖
cnpm install 

# 另开终端 前端文件目录下 启动前端
npm run dev

# 一起启动前后端 在前后端代码下
npm run dev

# 触发package.json中"dev": "concurrently \"npm run server\" \"npm run client\""
~~~





## 前端

### 创建项目

~~~shell
# 看vue版本
vue -V

# 创建项目
vue create client

# 出现提示
mannualy手动选择
Babel
TypeScript等 键盘a键代表全选 i表示反选 或者空格
选择Babel Router Vuex 回车

是否使用历史配置 yes 
用什么配置 package.json
是否保存模板 n

# 安装好后 cd client 启动项目
npm run serve

# 新开终端 启动后端
nodemon
~~~



~~~shell
# 前后端连载 在总的文件夹下安装concurrently模块将多个终端启动项目绑定在一块
cnpm install concurrently

# 配置 前后端的package.json
前端"start": "npm run serve" 这是启动前端项目
后端"client-install": "npm install -prefix client"  启动的时候首先装client的依赖模块
"client": "npm start --prefix client"  启动前端项目
"dev": "concurrently \"npm run  server\" \"npm run client\""

# 启动前后端项目
npm run dev
~~~



~~~html
http://localhost:5001/api/users/test
查看后端是否启动的链接
~~~



### 页面准备工作

~~~html
删掉不需要的vue 引入reset.css
~~~



### 设置Register和404组件

~~~html
安装elementUI并导入 main.js

把需要的图片放在assets下

views下创建Register.vue  写好结构和样式 配置路由

views下创建404.vue 写好结构和样式 配置路由
~~~



### 搭建elementUI注册表单

~~~html
使用ui的form表单: 自定义校验规则
引用样式
定义好数据
registerUser: {
    name: "",
    email: "",
    password1: "",
    password2: "",
    identity: "",
},
~~~



### 验证表单和按钮

~~~javascript
验证的规则
let validatePass2 = (rule, value, callback) => {
      if (value !== this.registerUser.password1) {
        callback(new Error("两次输入密码不一致!"));
      } else {
        callback();
      }
    };
rules: {
    // required: 是否必须填写, message:"提示信息", tirgger: 何时出发
    name: [
        { required: true, message: "用户名不能为空", tirgger: "change" },
        { min: 2, max: 30, message: "长度在2到30之间", tirgger: "blur" }
    ],
        email: [
            {
                type: "email",
                required: true,
                message: "邮箱格式不正确",
                tirgger: blur
            }
        ],
            password1: [
                { required: true, message: "密码不能为空", tirgger: "blur" },
                { min: 6, max: 30, message: "长度在6到30之间", tirgger: "blur" }
            ],
                password2: [
                    { required: true, message: "确认密码不能为空", tirgger: "blur" },
                    { min: 6, max: 30, message: "长度在2到30之间", tirgger: "blur" },
                    { validator: validatePass2, tirgger: blur }
                ]
}
submit事件
submitFrom: function(formName) {
      console.log(formName);
      this.$refs[formName].validate(valid => {
        if (valid) {
          alert("submit!");
        } else {
          console.log("error submit!!");
          return false;
        }
      });
    }
~~~





### 加载动画和消息提醒

~~~javascript
npm install axios

src下
http.js 请求文件
import axios form "axios"
export default axios;

main.js
import axios from "./http"
Vue.prototype.$axios = axios;

http.js
import { Loading } from 'element-ui';
Loading.service(options);

自己定义加载动画: 
let loading;
开始加载动画:
function startLoading() {
	loading = Loading.service({
        lock: true, // 是否锁定
        text: '拼命加载中。。。'，
        background: 'rgba(0,0,0,0.7)'   // 背景颜色	
	});
}
结束加载动画:
function endLoading() {
    loading.close();
}

请求拦截
axios.interceptors.request.use(config=>{
    // 加载动画
    startLoading();
    return config;
}, error=> {
    return Promise.reject(error);
});

响应拦截
axios.interceptors.response.use(response=> {
   // 结束加载动画
    endLoading();
    return response;
}, err=> {
    // 错误提醒
    // import { Message } from 'element-ui';
    endLoading();
    Message.error(errpr.response.data);
    return Promise.reject(error);
})
~~~



#### 跨域配置

~~~javascript
后端server.js也可以配置

前端
src下 新建vue.config.js


const path = require('path')
const debug = process.env.NODE_ENV !== 'production'

module.exports = {
    baseUrl: '/', // 根域上下文目录
    outputDir: 'dist', // 构建输出目录
    assetsDir: 'assets', // 静态资源目录 (js, css, img, fonts)
    lintOnSave: false, // 是否开启eslint保存检测，有效值：ture | false | 'error'
    runtimeCompiler: true, // 运行时版本是否需要编译
    transpileDependencies: [], // 默认babel-loader忽略mode_modules，这里可增加例外的依赖包名
    productionSourceMap: true, // 是否在构建生产包时生成 sourceMap 文件，false将提高构建速度
    configureWebpack: config => { // webpack配置，值位对象时会合并配置，为方法时会改写配置
        if (debug) { // 开发环境配置
            config.devtool = 'cheap-module-eval-source-map'
        } else { // 生产环境配置
        }
        // Object.assign(config, { // 开发生产共同配置
        //     resolve: {
        //         alias: {
        //             '@': path.resolve(__dirname, './src'),
        //             '@c': path.resolve(__dirname, './src/components'),
        //             'vue$': 'vue/dist/vue.esm.js'
        //         }
        //     }
        // })
    },
    chainWebpack: config => { // webpack链接API，用于生成和修改webapck配置，https://github.com/vuejs/vue-cli/blob/dev/docs/webpack.md
        if (debug) {
            // 本地开发配置
        } else {
            // 生产开发配置
        }
    },
    parallel: require('os').cpus().length > 1, // 构建时开启多进程处理babel编译
    pluginOptions: { // 第三方插件配置
    },
    pwa: { // 单页插件相关配置 https://github.com/vuejs/vue-cli/tree/dev/packages/%40vue/cli-plugin-pwa
    },
    devServer: {
        open: true,
        host: 'localhost',
        port: 8081,
        https: false,
        hotOnly: false,
        proxy: { // 配置跨域
            '/api': {
                target: 'http://localhost:5001/api/',  // 请求的接口
                ws: true, 
                changOrigin: true,  // 是否跨域
                pathRewrite: {
                    '^/api': ''
                }
            }
        },
        before: app => { }
    }
}

配置好后重新启动

Register.vue中
methods: {
    submitFrom: function(formName) {
      console.log(formName);
      this.$refs[formName].validate(valid => {
        if (valid) {
          // alert("submit!");这里改掉 提交后发送post请求 传递数据
            this.$axios.post('api/users/register', this.registerUser).then(res=>{
                // 注册成功
                this.$message({message:'账号注册成功!', type:'success'});   
            }); 
            this.$router.push('/login'); // 注册成功后跳转到login页面
        } else {
          console.log("error submit!!");
          return false;
        }
      });
    }
}
~~~

